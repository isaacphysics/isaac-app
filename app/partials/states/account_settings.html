<div desktop-panel>
    <div ng-if="editingSelf" class="row">
        <div class="medium-10 columns">
    	   <h1>Account Settings</h1>
    	   <h2 class="subheader">Create / update your <a ui-sref="home"><span class="ru_green">Isaac</span></a> account</h2>
        </div>
        <div class="medium-6 end columns text-right">
            <h2 class="ru-welcome logout-link">
                <a ui-sref="logout">Log out &raquo;</a>
            </h2>
        </div>
    </div>
    <div ng-if="!editingSelf" class="row">
        <div class="medium-10 columns">
           <h1>Manage a user's account</h1>
           <h2 class="subheader">Editing another user's <a ui-sref="home"><span class="ru_green">Isaac</span></a> account</h2>
        </div>
    </div>    
</div>
<div class="row account-settings-wrap">
    <div ng-if="editingSelf" class="show-for-small-only small-16 columns">
        <h1>Account settings</h1>
        <h2 class='subheader'>Set up your Isaac account, or <a ui-sref="logout">Log out &raquo;</a></h2>
    </div>
    <div ng-if="!editingSelf" class="show-for-small-only small-16 columns">
        <h1>Manage a user's account</h1>
        <h2 class='subheader'>Editing another user's Isaac account.</h2>
    </div>    
    <form class="panel" ng-submit="save()" name="account" novalidate>
        <!-- Had to use a bolck-grid here as the 16 col grid is not divisible by 3 -->
		<ul class="large-block-grid-3 medium-block-grid-1 small-block-grid-1 ru-pad">
            <li>
                <div class="row">
                    <div class="large-16 medium-8 columns">
            	       <label for="account-firstname">
                            <strong>First Name</strong>
                            <span class="ru-form-required"></span>
                            <span class="ru-error-message" ng-if="account.firstname.$invalid && account.firstname.$dirty">
                                Required
                            </span>
                        </label>
    				    <input id="account-firstname" name="firstname" type="text" ng-model="user.givenName" required>
                    </div>
                    <div class="large-16 medium-8 columns">
				        <label for="account-lastname">
                            <strong>Last Name</strong>
                            <span class="ru-form-required"></span>
                            <span class="ru-error-message" ng-if="account.secondname.$invalid && account.secondname.$dirty">
                                Required
                            </span>
                        </label>
    				    <input id="account-lastname" name="secondname" type="text" ng-model="user.familyName" required>
                    </div>
                </div>
                <div class="row">
                    <div class="large-16 columns">
				        <label for="account-email">
                            <strong>Your Email Address</strong>
                            <span class="ru-form-required"></span>
                            <span class="ru-error-message" ng-if="account.email.$invalid && account.email.$dirty">
                                Enter a valid email
                            </span>
                            </label>
    			         <input id="account-email" name="email" type="email" ng-model="user.email" required>
                    </div>
                </div>
                <div class="row">
                    <div ng-show="!user.role && editingSelf" class="large-16 columns">
                        <label>
                            <strong>Are you a teacher?</strong>
                        </label>
                        <a class="teacher-link" ui-sref="contact"><span class="underline">Contact us</span> for an upgraded account.</a>
                    </div>
                    <div ng-show="user.role && (user.role == 'TEACHER' || user.role == 'ADMIN' || user.role == 'CONTENT_EDITOR') && editingSelf" class="large-16 columns">
                        <label>
                            <strong>Upgraded account:</strong>
                        </label>
                        <p>Your account has been assigned the {{user.role.toLowerCase()}} role.</p>
                    </div>
                    <div ng-show="!editingSelf" class="large-16 columns">
                        <label>
                            <strong>Change user's role:</strong>
                        </label>
                        <select ng-model="user.role">
                            <option value="">No role</option>
                            <option value="TEACHER">Teacher</option>
                            <option value="CONTENT_EDITOR">Content Editor</option>
                            <option value="ADMIN">Admin</option>
                        </select>
                    </div>
                </div>
            </li>
            <li>
                <div ng-class="{'invisible': !user.hasSegueAccount}" class="row">
                    <div id="password-wrap" class="large-8 medium-8 columns">
                        <label for="account-password">
                            <!-- Change text if user doesn't have account -->
                            <strong ng-if="user.hasSegueAccount">Change password</strong>
                            <strong ng-if="!user.hasSegueAccount">Set password</strong>
                        </label>
                        <input id="account-password" type="password" ng-model="user.password" name="password" placeholder="Enter password">        
                    </div>
                    <div id="password2-wrap" class="large-8 medium-8 columns">
                        <label for="account-password2" ng-class="{'disabled' : !user.password}"><strong>Confirm password</strong></label>
                        <input id="account-password2" type="password" placeholder="Re-enter password" ng-disabled="!user.password" match="user.password" ng-model="password2" name="password2">
                        <span class="ru-error-message" ng-if="account.password2.$invalid && account.password2.$dirty">
                            Passwords do not match
                        </span>
                    </div>
                </div>
                <div id="account-gender" class="ac-custom ac-radio ac-fill row">
                    <div class="large-8 medium-8 small-8 columns">
                        <label for="r1">Male</label>
                        <input id="r1" name="r1" type="radio" ng-model="user.gender" value="MALE" question-radio-button>
                    </div>
                    <div class="large-8 medium-8 small-8 columns">
                        <label for="r2">Female</label>
                        <input id="r2" name="r1" type="radio" ng-model="user.gender" value="FEMALE" question-radio-button>
                    </div>

                </div>
                <div class="row">
                    <!-- Again this is due to the divisible by 3 issue -->
                    <div class="large-16 medium-16 columns">
                        <label><strong>Date of Birth</strong></label>
                    </div>
                    <ul class="large-block-grid-3 medium-block-grid-3 small-block-grid-3 ru-pad dob-wrap">
                        <li>
                            <select ng-model="dob.day" ng-options="day for day in datePicker.days">
                            </select>
                        </li>
                        <li>
	                        <select ng-model="dob.month" ng-options="month for month in datePicker.months">
	                        </select>
                        </li>
                        <li>
	                        <select ng-model="dob.year" ng-options="year for year in datePicker.years">
	                        </select>
                        </li>
                    </ul>
                </div>
            </li>
            <li>
                <div class="row">
                    <div class="large-16 medium-16 columns account-level">
                        <label><strong>Starting level</strong></label>
                        <select ng-model="user.defaultLevel">
                            <option value="1">1 (GCSE)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6 (Post A-Level)</option>
                        </select>
                    </div>
                </div>
            
		        <label>
    		        <strong>School</strong>
                </label>
    		    <div class="school-wrap" school-dropdown selected-school-urn="user.schoolId">
                    {{schools}}      
                </div>
                <input ng-hide="user.schoolId" ng-model="schoolOther" type="text" placeholder="Other">

                <label class="linked-accounts-title">Linked accounts</label>
                <ul class="large-block-grid-3 medium-block-grid-3 small-block-grid-3 linked-accounts">
                    <li ng-repeat="(key, value) in socialAccounts()" ng-class="{'linked': value == true}"ng-switch on="value">
                        <a tabindex="0" ng-switch-when="true" class="account-{{key | lowercase}}" ng-click="removeLinkedAccount(key)">
                            <span>Remove</span>
                        </a>
                        <a tabindex="0" ng-switch-default class="account-{{key | lowercase}}" ng-click="addLinkedAccount(key)">
                            <span>Add</span>
                        </a>
                    </li>
                </ul>
			</li>
        </ul>
        <ul class="large-block-grid-2 medium-block-grid-2 small-block-grid-1 ru-pad">
            <li><a class="ru-button-big expand" ng-click="save('/')">Save</a></li>
            <li class="delete-account-text">If you would like to delete your account please <a ui-sref="contact">contact us</a>.</li>
            <li ng-if="showSkip"><a class="ru-button-big expand secondary" ng-click="skip()">Skip this step</a></li>
        </ul>
        <ul class="small-block-grid-1 ru-pad" ng-if="updateSuccess || updateFail">
            <li ng-if="updateSuccess" class="text-center"><h4>Settings successfully updated</h4></li>
            <li ng-if="updateFail" class="text-center">
	            <h4 style="color:#a00;">
		            Settings could not be updated<span ng-if="errorMessage != null">: {{errorMessage}}</span>
	            </h4>
            </li>
        </ul>
       
    </form>
</div>
<div id="account-updated" class="reveal-modal" data-reveal>
    <h2>Your account has been successfully updated.</h2>
    <a class="close-reveal-modal"><img src="/assets/Close-button.jpg" alt="Close" /></a>
</div>