/**
 * @license Angulartics
 * (c) 2013 Luis Farzati http://luisfarzati.github.io/angulartics
 * Piwik 2.1.x update contributed by http://github.com/highskillz
 * License: MIT
 */
/* global _paq */
!function(a){"use strict";/**
     * @ngdoc overview
     * @name angulartics.piwik
     * Enables analytics support for Piwik (http://piwik.org/docs/tracking-api/)
     */
a.module("angulartics.piwik",["angulartics"]).config(["$analyticsProvider","$windowProvider",function(b,c){var d=c.$get();b.settings.pageTracking.trackRelativePath=!0,
// Add piwik specific trackers to angulartics API
// scope: visit or page. Defaults to 'page'
b.api.setCustomVariable=function(a,b,c,e){d._paq&&(e=e||"page",d._paq.push(["setCustomVariable",a,b,c,e]))},
// trackSiteSearch(keyword, category, [searchCount])
b.api.trackSiteSearch=function(b,c,e){
// keyword is required
if(d._paq&&b){var f=["trackSiteSearch",b,c||!1];
// searchCount is optional
a.isDefined(e)&&f.push(e),d._paq.push(f)}},
// logs a conversion for goal 1. revenue is optional
// trackGoal(goalID, [revenue]);
b.api.trackGoal=function(a,b){d._paq&&_paq.push(["trackGoal",a,b||0])},
// Set default angulartics page and event tracking
// $analytics.setUsername(username)
b.registerSetUsername(function(a){d._paq&&d._paq.push(["setUserId",a])}),
// $analytics.setAlias(alias)
// $analyticsProvider.registerSetAlias(function(param) {
//     // TODO: No piwik corresponding function found. Use setCustomVariable instead
// });
// $analytics.setUserProperties(properties)
// $analyticsProvider.registerSetUserProperties(function(param) {
//     // TODO: No piwik corresponding function found. Use setCustomVariable instead
// });
// locationObj is the angular $location object
b.registerPageTrack(function(a,b){d._paq&&(d._paq.push(["setDocumentTitle",d.document.title]),d._paq.push(["setCustomUrl",a]),d._paq.push(["trackPageView"]))}),
// trackEvent(category, event, [name], [value])
b.registerEventTrack(function(a,b){if(d._paq){
// PAQ requires that eventValue be an integer, see: http://piwik.org/docs/event-tracking/
if(b.value){var c=parseInt(b.value,10);b.value=isNaN(c)?0:c}d._paq.push(["trackEvent",b.category,a,b.label,b.value])}})}])}(angular);